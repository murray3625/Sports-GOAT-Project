---
title: "Visualizations"
author: "Matthew Murray"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, include=FALSE, warning=FALSE}

# libraries

library(janitor)
library(dplyr)
library(tidyverse)
library(lubridate)
library(stringi)
library(r2r)
library(purrr)
library(scales)
library(broom)

```

```{r}

# read-in
data <- read.csv("data.csv")

# truncate
data <- data[data$Year >= 1945, ]

# aggregate
data.agg <- data %>% group_by(Year) %>% summarise(N = sum(N))

```

\newpage

# Visualizations

## All Subjective Sports

```{r figure-1}

f1 <- ggplot(data = data, 
       aes(x = as.numeric(Year), y = as.integer(N), group = Sport, color = Sport)) + 
  scale_y_continuous(breaks = function(y) seq(floor(min(y, digits = 1)), 
                                              ceiling(max(y, digits = 1)), 
                                              by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential GOATs by Year (Version 8.0)",
       caption = "Figure 1") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))

f1

```

\newpage

```{r figure-2}

f2 <- ggplot(data = data.agg, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
  scale_y_continuous(limits = c(0, 12), breaks = seq(0, 12, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential GOATs by Year",
       caption = "Figure 2") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))

f2

```

\newpage

## Soccer

```{r figure-3}

soccer.filter = data[data$Sport == "Soccer",]

ggplot(data = soccer.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Soccer GOATs by Year",
       caption = "Figure 3") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```

\newpage

## Cricket

```{r figure-4}

cricket.filter = data[data$Sport == "Cricket",]

ggplot(data = cricket.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Cricket GOATs by Year",
       caption = "Figure 4") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```

\newpage

## Tennis

```{r figure-5}

tennis.filter = data[data$Sport == "Tennis",]

ggplot(data = tennis.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Tennis GOATs by Year",
       caption = "Figure 5") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```

\newpage

## Basketball

```{r figure-6}

basketball.filter = data[data$Sport == "Basketball",]

ggplot(data = basketball.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Basketball GOATs by Year",
       caption = "Figure 6") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```
\newpage

## Baseball

```{r figure-7}

football.filter = data[data$Sport == "Baseball",]

ggplot(data = football.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Baseball GOATs by Year",
       caption = "Figure 7") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```

\newpage

## Football

```{r figure-8}

football.filter = data[data$Sport == "Football",]

ggplot(data = football.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Football GOATs by Year",
       caption = "Figure 8") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```

\newpage

## Hockey

```{r figure-9}

hockey.filter = data[data$Sport == "Hockey",]

ggplot(data = hockey.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Hockey GOATs by Year",
       caption = "Figure 9") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```

\newpage

## Golf

```{r figure-10}

golf.filter = data[data$Sport == "Golf",]

ggplot(data = golf.filter, 
       aes(x = as.numeric(Year), y = as.integer(N))) + 
       scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 1))+
  geom_line() +
  labs(x = "Year", 
       y = "Number of Potential GOATs", 
       title = "Number of Potential Golf GOATs by Year",
       caption = "Figure 10") + 
  theme_bw() +
  theme(text = element_text(family = "serif")) +
  theme(plot.title=element_text(family = "serif", face = "bold", hjust = 0.5, size = 12))


```


\newpage

## Commentary & Notes

***Cricket & Baseball***

* There have not been any GOAT candidates in a while (before 1950). The GOAT for cricket is Sir Donald Bradman and that of baseball is Babe Ruth. Is this contention valid? Have there legitimately been no GOAT candidates in this long? If so, is there something intrinsic about these sports that make them so difficult to find GOAT-quality players? 

* Other questions that one can ask related to these sports is - would these players (Sir Donald Bradman and Babe Ruth) be as good as they were if they played today? 

***Hockey & Golf*** 

* The patterns that are seen with these sports appear to resemble what most people would likely expect: GOAT candidates occur sporadically without any legitimate pattern. Additionally, there has no been a GOAT in a while, and data does not suggest that there will be a GOAT candidate anytime soon (although this may be different if Tiger Woods is finally included as a GOAT candidate for golf). 

***Soccer, Tennis, Basketball, Football***

* Tennis also seems interesting because there were **22** consecutive years where there were at least **3** GOAT candidates playing at the same time. This 22 year windows spans from 2001 to 2022. 

* With basketball, there has been at least one GOAT candidate (playing) for a while. 

* An interesting note about football is that there were **4** GOAT candidates playing from 2000-2004. I personally wonder if this increase in GOAT candidates can be attributed to the inflation of the importance of the quarterback position, as 3 of the 4 candidates were quarterbacks (Brett Farve, Peyton Manning, and Tom Brady). Of course, the presence of 4 GOAT candidates can also be chalked up to mere coincidence, or simply the fact that we have multiple (2) lists of GOATs for football. 

\newpage

# Data Collection Assumptions

* For tennis, I imputed a player's active years using the years given in the *Stadium Talk* article that ranked the greatest tennis players of all time.

* For golf, I imputed a player's active years as the first and last calendar years that he won a major. For example, since Tiger Woods won his first major in 1997 and his last major in 2019, his active years are listed as 1997-2019, even though he is still playing in professional golf tournaments (in fact I know he most recently played in the Genesis Open). 

* Until 1995, only soccer players of European origin could win the Ballon d'Or. From 1995 to 2007, the award was open to players who played for European football clubs, regardless of their ethnicity. Only after 2007 could any player, with any club, win the award, which is why greats like Maradona and Pele never won the award. 

